{"remainingRequest":"C:\\work\\bi-admin-vue-new\\node_modules\\thread-loader\\dist\\cjs.js!C:\\work\\bi-admin-vue-new\\node_modules\\babel-loader\\lib\\index.js!C:\\work\\bi-admin-vue-new\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\work\\bi-admin-vue-new\\src\\components\\editor\\widgets\\author\\authorPlugin.js","dependencies":[{"path":"C:\\work\\bi-admin-vue-new\\src\\components\\editor\\widgets\\author\\authorPlugin.js","mtime":1552754725232},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _createClass from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\nimport BasePlugin from './../basePlugin';\nvar instance;\n\nvar AuthorPlugin =\n/*#__PURE__*/\nfunction (_BasePlugin) {\n  _inherits(AuthorPlugin, _BasePlugin);\n\n  _createClass(AuthorPlugin, [{\n    key: \"setListResource\",\n    value: function setListResource(resource) {\n      this.listResource = resource;\n    }\n  }], [{\n    key: \"createAndRegister\",\n    value: function createAndRegister(CKEDITOR) {\n      if (!instance) {\n        instance = new AuthorPlugin('author', 'Author', 'Edit Author', {\n          element: \"app-author\",\n          type: {\n            select: \"select\"\n          },\n          tab: {\n            basic: \"tab-basic\"\n          },\n          param: {\n            id: \"id\"\n          }\n        });\n      }\n\n      if (!CKEDITOR.plugins.registered[instance.code]) {\n        CKEDITOR.plugins.add(instance.code, {\n          init: function init(editor) {\n            instance.init(editor);\n          }\n        });\n      }\n\n      return instance;\n    }\n  }]);\n\n  function AuthorPlugin(code, buttonLabel, contextMenuEditLabel, ckOptions) {\n    var _this;\n\n    _classCallCheck(this, AuthorPlugin);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AuthorPlugin).call(this, code, buttonLabel, contextMenuEditLabel, ckOptions));\n\n    _defineProperty(_assertThisInitialized(_this), \"authors\", null);\n\n    return _this;\n  }\n\n  _createClass(AuthorPlugin, [{\n    key: \"registerCommand\",\n    value: function registerCommand(editor) {\n      editor.addCommand(this.code, new CKEDITOR.dialogCommand(this.code));\n    }\n  }, {\n    key: \"registerDialog\",\n    value: function registerDialog() {\n      var self = this;\n      CKEDITOR.dialog.add(this.code, function (editor) {\n        return {\n          title: 'Author Properties',\n          minWidth: 400,\n          minHeight: 200,\n          contents: [{\n            id: 'tab1',\n            label: 'Options',\n            title: 'Options',\n            elements: [{\n              type: 'select',\n              id: self.ckOptions.param.id,\n              label: 'Select Author',\n              validate: CKEDITOR.dialog.validate.notEmpty(\"Please select an author\"),\n              items: [],\n              default: null,\n              setup: function setup(widget) {\n                this.setValue(widget.element.$.getAttribute(self.ckOptions.param.id));\n              },\n              commit: function commit(elementOrWidget) {\n                if (elementOrWidget.element && elementOrWidget.element.$) {\n                  elementOrWidget.element.$.setAttribute(self.ckOptions.param.id, this.getValue());\n                  return;\n                }\n\n                elementOrWidget.setAttribute(self.ckOptions.param.id, this.getValue());\n              },\n              onLoad: function () {\n                var _onLoad = _asyncToGenerator(\n                /*#__PURE__*/\n                regeneratorRuntime.mark(function _callee(element) {\n                  var _this2 = this;\n\n                  var response, authors;\n                  return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return self.listResource.get();\n\n                        case 2:\n                          response = _context.sent;\n                          authors = response.body;\n                          authors.rows.forEach(function (author) {\n                            _this2.add(author.name, author.id);\n                          });\n\n                        case 5:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                function onLoad(_x) {\n                  return _onLoad.apply(this, arguments);\n                }\n\n                return onLoad;\n              }()\n            }]\n          }],\n          onShow: function () {\n            var _onShow = _asyncToGenerator(\n            /*#__PURE__*/\n            regeneratorRuntime.mark(function _callee2() {\n              var selection, element;\n              return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      selection = editor.getSelection();\n                      element = selection.getStartElement();\n\n                      if (element) {\n                        element = element.getAscendant(self.ckOptions.element, true);\n                      }\n\n                      if (!element || element.getName() != self.ckOptions.element) {\n                        element = editor.document.createElement(self.ckOptions.element);\n                        this.insertMode = true;\n                      } else {\n                        this.insertMode = false;\n                      }\n\n                      this.element = element;\n                      if (!this.insertMode) this.setupContent(this.element);\n\n                    case 6:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, _callee2, this);\n            }));\n\n            function onShow() {\n              return _onShow.apply(this, arguments);\n            }\n\n            return onShow;\n          }(),\n          onOk: function onOk() {\n            this.commitContent(this.element);\n\n            if (this.insertMode) {\n              editor.insertHtml(this.element.$.outerHTML);\n              editor.widgets.initOn(this.element, self.ckOptions.element);\n            }\n          }\n        };\n      });\n    }\n  }]);\n\n  return AuthorPlugin;\n}(BasePlugin);\n\nexport default AuthorPlugin;",{"version":3,"sources":["C:\\work\\bi-admin-vue-new\\src\\components\\editor\\widgets\\author\\authorPlugin.js"],"names":["BasePlugin","instance","AuthorPlugin","resource","listResource","CKEDITOR","element","type","select","tab","basic","param","id","plugins","registered","code","add","init","editor","buttonLabel","contextMenuEditLabel","ckOptions","addCommand","dialogCommand","self","dialog","title","minWidth","minHeight","contents","label","elements","validate","notEmpty","items","default","setup","widget","setValue","$","getAttribute","commit","elementOrWidget","setAttribute","getValue","onLoad","get","response","authors","body","rows","forEach","author","name","onShow","selection","getSelection","getStartElement","getAscendant","getName","document","createElement","insertMode","setupContent","onOk","commitContent","insertHtml","outerHTML","widgets","initOn"],"mappings":";;;;;;;;;;;AAAA,OAAOA,UAAP,MAAuB,iBAAvB;AAEA,IAAIC,QAAJ;;IAEMC,Y;;;;;;;oCA6BcC,Q,EAAU;AACtB,WAAKC,YAAL,GAAoBD,QAApB;AACH;;;sCA5BwBE,Q,EAAU;AAE/B,UAAI,CAACJ,QAAL,EAAe;AACXA,QAAAA,QAAQ,GAAG,IAAIC,YAAJ,CAAiB,QAAjB,EAA2B,QAA3B,EAAqC,aAArC,EAAoD;AAC3DI,UAAAA,OAAO,EAAE,YADkD;AAE3DC,UAAAA,IAAI,EAAK;AACLC,YAAAA,MAAM,EAAE;AADH,WAFkD;AAK3DC,UAAAA,GAAG,EAAM;AACLC,YAAAA,KAAK,EAAE;AADF,WALkD;AAQ3DC,UAAAA,KAAK,EAAI;AACLC,YAAAA,EAAE,EAAE;AADC;AARkD,SAApD,CAAX;AAYH;;AACD,UAAI,CAACP,QAAQ,CAACQ,OAAT,CAAiBC,UAAjB,CAA4Bb,QAAQ,CAACc,IAArC,CAAL,EAAiD;AAC7CV,QAAAA,QAAQ,CAACQ,OAAT,CAAiBG,GAAjB,CAAqBf,QAAQ,CAACc,IAA9B,EAAoC;AAChCE,UAAAA,IAAI,EAAE,cAASC,MAAT,EAAiB;AACnBjB,YAAAA,QAAQ,CAACgB,IAAT,CAAcC,MAAd;AACH;AAH+B,SAApC;AAKH;;AACD,aAAOjB,QAAP;AACH;;;AAMD,wBAAYc,IAAZ,EAAkBI,WAAlB,EAA+BC,oBAA/B,EAAqDC,SAArD,EAAgE;AAAA;;AAAA;;AAC5D,sFAAMN,IAAN,EAAYI,WAAZ,EAAyBC,oBAAzB,EAA+CC,SAA/C;;AAD4D,8DAhCtD,IAgCsD;;AAAA;AAE/D;;;;oCAEeH,M,EAAQ;AACpBA,MAAAA,MAAM,CAACI,UAAP,CAAkB,KAAKP,IAAvB,EAA6B,IAAIV,QAAQ,CAACkB,aAAb,CAA2B,KAAKR,IAAhC,CAA7B;AACH;;;qCAEgB;AACb,UAAIS,IAAI,GAAG,IAAX;AACAnB,MAAAA,QAAQ,CAACoB,MAAT,CAAgBT,GAAhB,CAAoB,KAAKD,IAAzB,EAA+B,UAACG,MAAD,EAAY;AACvC,eAAO;AACHQ,UAAAA,KAAK,EAAM,mBADR;AAEHC,UAAAA,QAAQ,EAAG,GAFR;AAGHC,UAAAA,SAAS,EAAE,GAHR;AAIHC,UAAAA,QAAQ,EAAG,CACP;AACIjB,YAAAA,EAAE,EAAQ,MADd;AAEIkB,YAAAA,KAAK,EAAK,SAFd;AAGIJ,YAAAA,KAAK,EAAK,SAHd;AAIIK,YAAAA,QAAQ,EAAE,CACN;AACIxB,cAAAA,IAAI,EAAM,QADd;AAEIK,cAAAA,EAAE,EAAQY,IAAI,CAACH,SAAL,CAAeV,KAAf,CAAqBC,EAFnC;AAGIkB,cAAAA,KAAK,EAAK,eAHd;AAIIE,cAAAA,QAAQ,EAAE3B,QAAQ,CAACoB,MAAT,CAAgBO,QAAhB,CAAyBC,QAAzB,CAAkC,yBAAlC,CAJd;AAKIC,cAAAA,KAAK,EAAK,EALd;AAMIC,cAAAA,OAAO,EAAG,IANd;AAOIC,cAAAA,KAAK,EAAK,eAASC,MAAT,EAAiB;AACvB,qBAAKC,QAAL,CAAcD,MAAM,CAAC/B,OAAP,CAAeiC,CAAf,CAAiBC,YAAjB,CAA8BhB,IAAI,CAACH,SAAL,CAAeV,KAAf,CAAqBC,EAAnD,CAAd;AACH,eATL;AAUI6B,cAAAA,MAAM,EAAI,gBAASC,eAAT,EAA0B;AAChC,oBAAIA,eAAe,CAACpC,OAAhB,IAA2BoC,eAAe,CAACpC,OAAhB,CAAwBiC,CAAvD,EAA0D;AACtDG,kBAAAA,eAAe,CAACpC,OAAhB,CAAwBiC,CAAxB,CAA0BI,YAA1B,CAAuCnB,IAAI,CAACH,SAAL,CAAeV,KAAf,CAAqBC,EAA5D,EAAgE,KAAKgC,QAAL,EAAhE;AACA;AACH;;AACDF,gBAAAA,eAAe,CAACC,YAAhB,CAA6BnB,IAAI,CAACH,SAAL,CAAeV,KAAf,CAAqBC,EAAlD,EAAsD,KAAKgC,QAAL,EAAtD;AACH,eAhBL;AAiBIC,cAAAA,MAAM;AAAA;AAAA;AAAA,wCAAI,iBAAevC,OAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCACiBkB,IAAI,CAACpB,YAAL,CAAkB0C,GAAlB,EADjB;;AAAA;AACAC,0BAAAA,QADA;AAEAC,0BAAAA,OAFA,GAEWD,QAAQ,CAACE,IAFpB;AAGND,0BAAAA,OAAO,CAACE,IAAR,CAAaC,OAAb,CAAqB,UAAAC,MAAM,EAAI;AAC3B,4BAAA,MAAI,CAACpC,GAAL,CAASoC,MAAM,CAACC,IAAhB,EAAsBD,MAAM,CAACxC,EAA7B;AACH,2BAFD;;AAHM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAjBV,aADM;AAJd,WADO,CAJR;AAsCH0C,UAAAA,MAAM;AAAA;AAAA;AAAA,oCAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAEHC,sBAAAA,SAFG,GAESrC,MAAM,CAACsC,YAAP,EAFT;AAGHlD,sBAAAA,OAHG,GAGSiD,SAAS,CAACE,eAAV,EAHT;;AAKP,0BAAInD,OAAJ,EAAa;AACTA,wBAAAA,OAAO,GAAGA,OAAO,CAACoD,YAAR,CAAqBlC,IAAI,CAACH,SAAL,CAAef,OAApC,EAA6C,IAA7C,CAAV;AACH;;AAED,0BAAI,CAACA,OAAD,IAAYA,OAAO,CAACqD,OAAR,MAAqBnC,IAAI,CAACH,SAAL,CAAef,OAApD,EAA6D;AACzDA,wBAAAA,OAAO,GAAWY,MAAM,CAAC0C,QAAP,CAAgBC,aAAhB,CAA8BrC,IAAI,CAACH,SAAL,CAAef,OAA7C,CAAlB;AACA,6BAAKwD,UAAL,GAAkB,IAAlB;AACH,uBAHD,MAIK;AACD,6BAAKA,UAAL,GAAkB,KAAlB;AACH;;AAED,2BAAKxD,OAAL,GAAeA,OAAf;AACA,0BAAI,CAAC,KAAKwD,UAAV,EACI,KAAKC,YAAL,CAAkB,KAAKzD,OAAvB;;AAnBG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAL;;AAAA;AAAA;AAAA;;AAAA;AAAA,aAtCH;AA2DH0D,UAAAA,IAAI,EAAO,gBAAW;AAClB,iBAAKC,aAAL,CAAmB,KAAK3D,OAAxB;;AACA,gBAAI,KAAKwD,UAAT,EAAqB;AACjB5C,cAAAA,MAAM,CAACgD,UAAP,CAAkB,KAAK5D,OAAL,CAAaiC,CAAb,CAAe4B,SAAjC;AACAjD,cAAAA,MAAM,CAACkD,OAAP,CAAeC,MAAf,CAAsB,KAAK/D,OAA3B,EAAoCkB,IAAI,CAACH,SAAL,CAAef,OAAnD;AACH;AACJ;AAjEE,SAAP;AAmEH,OApED;AAqEH;;;;EAhHsBN,U;;AAmH3B,eAAeE,YAAf","sourcesContent":["import BasePlugin from './../basePlugin';\r\n\r\nlet instance;\r\n\r\nclass AuthorPlugin extends BasePlugin {\r\n    authors = null;\r\n\r\n    static createAndRegister(CKEDITOR) {\r\n\r\n        if (!instance) {\r\n            instance = new AuthorPlugin('author', 'Author', 'Edit Author', {\r\n                element: \"app-author\",\r\n                type   : {\r\n                    select: \"select\"\r\n                },\r\n                tab    : {\r\n                    basic: \"tab-basic\",\r\n                },\r\n                param  : {\r\n                    id: \"id\"\r\n                }\r\n            });\r\n        }\r\n        if (!CKEDITOR.plugins.registered[instance.code]) {\r\n            CKEDITOR.plugins.add(instance.code, {\r\n                init: function(editor) {\r\n                    instance.init(editor);\r\n                }\r\n            });\r\n        }\r\n        return instance;\r\n    }\r\n\r\n    setListResource(resource) {\r\n        this.listResource = resource;\r\n    }\r\n\r\n    constructor(code, buttonLabel, contextMenuEditLabel, ckOptions) {\r\n        super(code, buttonLabel, contextMenuEditLabel, ckOptions);\r\n    }\r\n\r\n    registerCommand(editor) {\r\n        editor.addCommand(this.code, new CKEDITOR.dialogCommand(this.code));\r\n    }\r\n\r\n    registerDialog() {\r\n        let self = this;\r\n        CKEDITOR.dialog.add(this.code, (editor) => {\r\n            return {\r\n                title    : 'Author Properties',\r\n                minWidth : 400,\r\n                minHeight: 200,\r\n                contents : [\r\n                    {\r\n                        id      : 'tab1',\r\n                        label   : 'Options',\r\n                        title   : 'Options',\r\n                        elements: [\r\n                            {\r\n                                type    : 'select',\r\n                                id      : self.ckOptions.param.id,\r\n                                label   : 'Select Author',\r\n                                validate: CKEDITOR.dialog.validate.notEmpty(\"Please select an author\"),\r\n                                items   : [],\r\n                                default : null,\r\n                                setup   : function(widget) {\r\n                                    this.setValue(widget.element.$.getAttribute(self.ckOptions.param.id));\r\n                                },\r\n                                commit  : function(elementOrWidget) {\r\n                                    if (elementOrWidget.element && elementOrWidget.element.$) {\r\n                                        elementOrWidget.element.$.setAttribute(self.ckOptions.param.id, this.getValue());\r\n                                        return;\r\n                                    }\r\n                                    elementOrWidget.setAttribute(self.ckOptions.param.id, this.getValue());\r\n                                },\r\n                                onLoad  : async function(element) {\r\n                                    const response = await self.listResource.get();\r\n                                    const authors  = response.body;\r\n                                    authors.rows.forEach(author => {\r\n                                        this.add(author.name, author.id);\r\n                                    });\r\n                                }\r\n                            }\r\n                        ]\r\n                    }\r\n                ],\r\n                onShow   : async function() {\r\n\r\n                    var selection = editor.getSelection();\r\n                    var element   = selection.getStartElement();\r\n\r\n                    if (element) {\r\n                        element = element.getAscendant(self.ckOptions.element, true);\r\n                    }\r\n\r\n                    if (!element || element.getName() != self.ckOptions.element) {\r\n                        element         = editor.document.createElement(self.ckOptions.element);\r\n                        this.insertMode = true;\r\n                    }\r\n                    else {\r\n                        this.insertMode = false;\r\n                    }\r\n\r\n                    this.element = element;\r\n                    if (!this.insertMode)\r\n                        this.setupContent(this.element);\r\n                },\r\n                onOk     : function() {\r\n                    this.commitContent(this.element);\r\n                    if (this.insertMode) {\r\n                        editor.insertHtml(this.element.$.outerHTML);\r\n                        editor.widgets.initOn(this.element, self.ckOptions.element);\r\n                    }\r\n                }\r\n            };\r\n        });\r\n    }\r\n}\r\n\r\nexport default AuthorPlugin;\r\n"]}]}