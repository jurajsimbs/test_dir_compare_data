{"remainingRequest":"C:\\work\\bi-admin-vue-new\\node_modules\\thread-loader\\dist\\cjs.js!C:\\work\\bi-admin-vue-new\\node_modules\\babel-loader\\lib\\index.js!C:\\work\\bi-admin-vue-new\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\work\\bi-admin-vue-new\\src\\components\\editor\\widgets\\giphy\\giphyPlugin.js","dependencies":[{"path":"C:\\work\\bi-admin-vue-new\\src\\components\\editor\\widgets\\giphy\\giphyPlugin.js","mtime":1552754725240},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\bi-admin-vue-new\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"C:\\\\work\\\\bi-admin-vue-new\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport BasePlugin from './../basePlugin';\nvar instance;\n\nvar GiphyPlugin =\n/*#__PURE__*/\nfunction (_BasePlugin) {\n  _inherits(GiphyPlugin, _BasePlugin);\n\n  _createClass(GiphyPlugin, [{\n    key: \"registerButton\",\n    value: function registerButton(editor) {\n      _get(_getPrototypeOf(GiphyPlugin.prototype), \"registerButton\", this).call(this, editor);\n\n      editor.ui.addButton('giphy', {\n        label: 'Add Giphy',\n        command: 'giphy',\n        icon: 'giphy'\n      });\n    }\n  }, {\n    key: \"registerWidget\",\n    value: function registerWidget(editor) {\n      var self = this;\n      editor.widgets.add(this.ckOptions.element, {\n        allowedContent: true,\n        upcast: function upcast(element) {\n          return element.className === 'giphy';\n        },\n        dialog: this.code\n      });\n    }\n  }, {\n    key: \"registerContextMenu\",\n    value: function registerContextMenu(editor) {\n      var self = this;\n      editor.addMenuGroup('giphy', 1);\n      editor.addMenuItems({\n        giphy_deleteGiphy: {\n          label: 'Delete giphy',\n          group: 'giphy',\n          command: self.code + 'delete',\n          order: 1\n        },\n        giphy_props: {\n          label: 'Giphy properties',\n          group: 'giphy',\n          command: self.code + 'props',\n          order: 2\n        }\n      });\n      editor.contextMenu.addListener(function (element, selection, path) {\n        if (element.$.classList && element.$.classList.contains('giphy') || element.$.closest('.giphy')) {\n          return {\n            giphy: CKEDITOR.TRISTATE_OFF,\n            giphy_deleteGiphy: CKEDITOR.TRISTATE_OFF,\n            giphy_props: CKEDITOR.TRISTATE_OFF\n          };\n        }\n\n        return null;\n      });\n    }\n  }, {\n    key: \"registerCommand\",\n    value: function registerCommand(editor) {\n      var self = this;\n\n      self.editMethod =\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(editor, self) {\n          var selection, element, giphy, giphyData, newProps, item, newElement;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  selection = editor.getSelection();\n                  element = selection.getStartElement();\n                  giphy = element.$.closest('.giphy');\n                  giphyData = {};\n                  giphy.childNodes.forEach(function (element) {\n                    if (element.localName == 'app-giphy') {\n                      giphyData = element;\n                    }\n                  });\n                  _context.next = 7;\n                  return self.onShowDialogRequested('giphy', giphyData);\n\n                case 7:\n                  newProps = _context.sent;\n\n                  if (newProps) {\n                    _context.next = 10;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\");\n\n                case 10:\n                  while (giphy.firstChild) {\n                    giphy.removeChild(giphy.firstChild);\n                  }\n\n                  item = editor.document.createElement('app-giphy');\n                  item.$.setAttribute('id', newProps.id);\n                  item.$.setAttribute('responsive', newProps.responsive);\n                  item.$.setAttribute('height', newProps.height);\n                  item.$.setAttribute('width', newProps.width);\n                  item.$.setAttribute('url', newProps.url);\n                  giphy.appendChild(item.$);\n                  editor.fire('change');\n                  newElement = document.getElementById(newProps.id);\n                  newElement.addEventListener('dblclick', function (event) {\n                    self.editMethod(editor, self);\n                  });\n\n                case 21:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x, _x2) {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      editor.addCommand(this.code + 'props', {\n        exec: function exec() {\n          self.editMethod(editor, self);\n        }\n      });\n      editor.addCommand(this.code + 'delete', {\n        exec: function () {\n          var _exec = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee2() {\n            var selection, element, giphy, confirmation;\n            return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    selection = editor.getSelection();\n                    element = selection.getStartElement();\n                    giphy = element.$.closest('.giphy');\n                    _context2.next = 5;\n                    return self.confirm('Giphy will be lost! Delete?');\n\n                  case 5:\n                    confirmation = _context2.sent;\n\n                    if (confirmation) {\n                      while (giphy.firstChild) {\n                        giphy.removeChild(giphy.firstChild);\n                      }\n\n                      giphy.parentElement.removeChild(giphy);\n                    }\n\n                    editor.fire('change');\n\n                  case 8:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2);\n          }));\n\n          function exec() {\n            return _exec.apply(this, arguments);\n          }\n\n          return exec;\n        }()\n      });\n      editor.addCommand(this.code, {\n        exec: function () {\n          var _exec2 = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee3() {\n            var selection, element, newProps, item, newElement;\n            return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n              while (1) {\n                switch (_context3.prev = _context3.next) {\n                  case 0:\n                    selection = editor.getSelection();\n                    element = selection.getStartElement();\n\n                    if (element) {\n                      element = element.getAscendant(self.ckOptions.element, true);\n                    }\n\n                    if (!(!element || element.getName() !== self.ckOptions.element || element)) {\n                      _context3.next = 23;\n                      break;\n                    }\n\n                    element = editor.document.createElement('div');\n                    element.$.classList.add('giphy');\n                    _context3.next = 8;\n                    return self.onShowDialogRequested('giphy', {});\n\n                  case 8:\n                    newProps = _context3.sent;\n\n                    if (newProps) {\n                      _context3.next = 11;\n                      break;\n                    }\n\n                    return _context3.abrupt(\"return\");\n\n                  case 11:\n                    item = editor.document.createElement('app-giphy');\n                    item.$.setAttribute('id', newProps.id);\n                    item.$.setAttribute('responsive', newProps.responsive);\n                    item.$.setAttribute('height', newProps.height);\n                    item.$.setAttribute('width', newProps.width);\n                    item.$.setAttribute('url', newProps.url);\n                    element.$.innerHTML = null;\n                    element.$.appendChild(item.$);\n                    editor.insertHtml(element.$.outerHTML);\n                    editor.widgets.initOn(element, self.code);\n                    newElement = document.getElementById(newProps.id);\n                    newElement.addEventListener('dblclick', function (event) {\n                      self.editMethod(editor, self);\n                    });\n\n                  case 23:\n                  case \"end\":\n                    return _context3.stop();\n                }\n              }\n            }, _callee3);\n          }));\n\n          function exec() {\n            return _exec2.apply(this, arguments);\n          }\n\n          return exec;\n        }()\n      });\n    }\n  }], [{\n    key: \"createAndRegister\",\n    value: function createAndRegister(CKEDITOR) {\n      if (!instance) {\n        instance = new GiphyPlugin('giphy', 'Giphy', 'Edit Giphy Post', {\n          element: \"div\"\n        });\n      }\n\n      if (!CKEDITOR.plugins.registered[instance.code]) {\n        CKEDITOR.plugins.add(instance.code, {\n          init: function init(editor) {\n            instance.init(editor);\n          },\n          requires: 'contextmenu'\n        });\n      }\n\n      return instance;\n    }\n  }]);\n\n  function GiphyPlugin(code, buttonLabel, contextMenuEditLabel, ckOptions) {\n    _classCallCheck(this, GiphyPlugin);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(GiphyPlugin).call(this, code, buttonLabel, contextMenuEditLabel, ckOptions));\n  }\n\n  return GiphyPlugin;\n}(BasePlugin);\n\nexport default GiphyPlugin;",{"version":3,"sources":["C:\\work\\bi-admin-vue-new\\src\\components\\editor\\widgets\\giphy\\giphyPlugin.js"],"names":["BasePlugin","instance","GiphyPlugin","editor","ui","addButton","label","command","icon","self","widgets","add","ckOptions","element","allowedContent","upcast","className","dialog","code","addMenuGroup","addMenuItems","giphy_deleteGiphy","group","order","giphy_props","contextMenu","addListener","selection","path","$","classList","contains","closest","giphy","CKEDITOR","TRISTATE_OFF","editMethod","getSelection","getStartElement","giphyData","childNodes","forEach","localName","onShowDialogRequested","newProps","firstChild","removeChild","item","document","createElement","setAttribute","id","responsive","height","width","url","appendChild","fire","newElement","getElementById","addEventListener","event","addCommand","exec","confirm","confirmation","parentElement","getAscendant","getName","innerHTML","insertHtml","outerHTML","initOn","plugins","registered","init","requires","buttonLabel","contextMenuEditLabel"],"mappings":"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","sourcesContent":["import BasePlugin from './../basePlugin';\r\n\r\nlet instance;\r\n\r\nclass GiphyPlugin extends BasePlugin {\r\n    static createAndRegister(CKEDITOR) {\r\n        if (!instance) {\r\n            instance = new GiphyPlugin('giphy', 'Giphy', 'Edit Giphy Post', {\r\n                element: \"div\"\r\n            });\r\n        }\r\n        if (!CKEDITOR.plugins.registered[instance.code]) {\r\n            CKEDITOR.plugins.add(instance.code, {\r\n                init    : function (editor) {\r\n                    instance.init(editor);\r\n                },\r\n                requires : 'contextmenu'\r\n            });\r\n        }\r\n        return instance;\r\n    }\r\n\r\n    registerButton(editor) {\r\n        super.registerButton(editor);\r\n        editor.ui.addButton('giphy', {\r\n            label  : 'Add Giphy',\r\n            command: 'giphy',\r\n            icon   : 'giphy'\r\n        });\r\n    }\r\n\r\n    registerWidget(editor) {\r\n        let self = this;\r\n        editor.widgets.add(this.ckOptions.element, {\r\n            allowedContent: true,\r\n            upcast        : function (element) {\r\n                return element.className === 'giphy';\r\n            },\r\n            dialog: this.code\r\n        });\r\n    }\r\n\r\n    registerContextMenu(editor) {\r\n        let self = this;\r\n        editor.addMenuGroup('giphy', 1);\r\n        editor.addMenuItems({\r\n            giphy_deleteGiphy : {\r\n                label  : 'Delete giphy',\r\n                group  : 'giphy',\r\n                command: self.code + 'delete',\r\n                order  : 1\r\n            },\r\n            giphy_props       : {\r\n                label  : 'Giphy properties',\r\n                group  : 'giphy',\r\n                command: self.code + 'props',\r\n                order  : 2\r\n            }\r\n        });\r\n        editor.contextMenu.addListener(function (element, selection, path) {\r\n            if (element.$.classList && element.$.classList.contains('giphy') || element.$.closest('.giphy')) {\r\n                return {\r\n                    giphy               : CKEDITOR.TRISTATE_OFF,\r\n                    giphy_deleteGiphy   : CKEDITOR.TRISTATE_OFF,\r\n                    giphy_props         : CKEDITOR.TRISTATE_OFF\r\n                };\r\n            }\r\n            return null;\r\n        });\r\n    }\r\n\r\n    registerCommand(editor) {\r\n        let self = this;\r\n\r\n        self.editMethod = async function (editor, self) {\r\n            let selection = editor.getSelection();\r\n            let element = selection.getStartElement();\r\n\r\n            let giphy = element.$.closest('.giphy');\r\n            let giphyData = {};\r\n            giphy.childNodes.forEach(element => {\r\n                if (element.localName == 'app-giphy') {\r\n                    giphyData = element;\r\n                }\r\n            });\r\n            let newProps = await self.onShowDialogRequested('giphy', giphyData);\r\n            if (!newProps) {\r\n                return;\r\n            }\r\n\r\n            while (giphy.firstChild) {\r\n                giphy.removeChild(giphy.firstChild);\r\n            }\r\n\r\n            let item = editor.document.createElement('app-giphy');\r\n            item.$.setAttribute('id', newProps.id);\r\n            item.$.setAttribute('responsive', newProps.responsive);\r\n            item.$.setAttribute('height', newProps.height);\r\n            item.$.setAttribute('width', newProps.width);\r\n            item.$.setAttribute('url', newProps.url);\r\n            giphy.appendChild(item.$);\r\n            editor.fire('change');\r\n\r\n            let newElement = document.getElementById(newProps.id);\r\n            newElement.addEventListener('dblclick', function(event) { self.editMethod(editor, self); });\r\n        };\r\n\r\n        editor.addCommand(this.code + 'props', {\r\n            exec: () => { self.editMethod(editor, self); }\r\n        });\r\n        editor.addCommand(this.code + 'delete', {\r\n            exec: async function () {\r\n                let selection = editor.getSelection();\r\n                let element = selection.getStartElement();\r\n                let giphy = element.$.closest('.giphy');\r\n                let confirmation = await self.confirm('Giphy will be lost! Delete?');\r\n                if (confirmation) {\r\n                    while (giphy.firstChild) {\r\n                        giphy.removeChild(giphy.firstChild);\r\n                    }\r\n                    giphy.parentElement.removeChild(giphy);\r\n                }\r\n                editor.fire('change');\r\n            }\r\n        });\r\n        editor.addCommand(this.code, {\r\n            exec: async function () {\r\n                let selection = editor.getSelection();\r\n                let element = selection.getStartElement();\r\n\r\n                if (element) {\r\n                    element = element.getAscendant(self.ckOptions.element, true);\r\n                }\r\n\r\n                if (!element || element.getName() !== self.ckOptions.element || element) {\r\n                    element = editor.document.createElement('div');\r\n                    element.$.classList.add('giphy');\r\n\r\n                    let newProps = await self.onShowDialogRequested('giphy', {});\r\n                    if (!newProps) {\r\n                        return;\r\n                    }\r\n\r\n                    let item = editor.document.createElement('app-giphy');\r\n                    item.$.setAttribute('id', newProps.id);\r\n                    item.$.setAttribute('responsive', newProps.responsive);\r\n                    item.$.setAttribute('height', newProps.height);\r\n                    item.$.setAttribute('width', newProps.width);\r\n                    item.$.setAttribute('url', newProps.url);\r\n                    element.$.innerHTML = null;\r\n                    element.$.appendChild(item.$);\r\n                    editor.insertHtml(element.$.outerHTML);\r\n                    editor.widgets.initOn(element, self.code);\r\n\r\n                    let newElement = document.getElementById(newProps.id);\r\n                    newElement.addEventListener('dblclick', function(event) { self.editMethod(editor, self); });\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    constructor(code, buttonLabel, contextMenuEditLabel, ckOptions) {\r\n        super(code, buttonLabel, contextMenuEditLabel, ckOptions);\r\n    }\r\n}\r\n\r\nexport default GiphyPlugin;"]}]}